---
title: "Chapter 14: Frequency Domain Methods"
author: "Student Name"
date: today
format:
  html:
    code-fold: true
    toc: true
    embed-resources: true
    df-print: paged
execute:
  warning: false
  message: false
---

```{r}
#| label: setup
#| include: false

library(ggplot2)
library(dplyr)
library(astsa)
library(eda4mlr)
```

## Learning Objectives

<!-- Review the learning objectives listed in the chapter and note them here. -->



## Reading Notes

<!-- Key concepts, questions, and observations from reading the chapter. -->



## The Big Picture

> Instead of asking "how does the past predict the future?", ask "what frequencies contribute to the variation?"---a complementary view of time series structure.

---

## Choosing Your Time Series

For this chapter, select a series with clear periodic structure:

**Suggested sources from `astsa` package:**

- `astsa::soi` --- Southern Oscillation Index (El Nino signal)
- `astsa::rec` --- recruitment (pairs well with SOI for coherence)
- `astsa::sunspotz` --- sunspot numbers (strong ~11 year cycle)
- `astsa::EQ5` / `astsa::EXP6` --- seismic data

```{r}
#| label: load-data

# Load your time series here
# Example: my_ts <- astsa::soi
```

---

## Exercise 1: The Periodogram

### Task 1.1: Compute the Periodogram

The periodogram decomposes the variance of a time series across frequencies. Compute it using `stats::spectrum()` or `astsa::mvspec()`.

```{r}
#| label: ex1-periodogram

# Your code here
```

*What do you see? Are there dominant frequencies?*



### Task 1.2: Identify Peaks

Find the frequency with the highest spectral power. Convert this frequency to a period (period = 1/frequency, adjusted for your time units).

```{r}
#| label: ex1-peaks

# Your code here
```

*What is the dominant period? Does this match a known cycle in your data?*



### Task 1.3: The Periodogram Is Inconsistent

The raw periodogram is a poor estimator of the true spectral density---it fails to become more precise as sample size increases.

In your own words, how would you explain the necessity of smoothing to a friend?

*Your explanation:*



---

## Exercise 2: Smoothed Spectral Estimates

### Task 2.1: Apply Smoothing

Compute a smoothed spectral estimate using `astsa::mvspec()` with different spans (bandwidth parameters).

```{r}
#| label: ex2-smoothing

# Your code here
```

*How does increasing the span affect the estimate?*



### Task 2.2: Bias-Variance Tradeoff

- Wider bandwidth --- smoother estimate, less variance, more bias
- Narrower bandwidth --- rougher estimate, more variance, less bias

Demonstrate this tradeoff by plotting spectra with different bandwidths.

```{r}
#| label: ex2-tradeoff

# Your code here
```

*If a friend had to choose a bandwidth for this data, how would you advise them?*



---

## Exercise 3: Theoretical Spectra

### Task 3.1: Spectrum of AR(1)

An AR(1) process $x_t = \phi x_{t-1} + w_t$ has spectral density:

$$f(\omega) = \frac{\sigma_w^2}{1 - 2\phi\cos(2\pi\omega) + \phi^2}$$

Simulate an AR(1) process and compare the estimated spectrum to the theoretical spectrum.

```{r}
#| label: ex3-ar1-spectrum

# Your code here
```

*How well does the estimated spectrum match the theory?*



### Task 3.2: Spectrum of MA(1)

An MA(1) process $x_t = w_t + \theta w_{t-1}$ has spectral density:

$$f(\omega) = \sigma_w^2 (1 + 2\theta\cos(2\pi\omega) + \theta^2)$$

Simulate an MA(1) process and compare the estimated and theoretical spectra.

```{r}
#| label: ex3-ma1-spectrum

# Your code here
```

*Describe the shape of the MA(1) spectrum for positive vs. negative θ.*



---

## Exercise 4: Coherence

### Task 4.1: Two Related Series

Choose two time series that might be related (e.g., `astsa::soi` and `astsa::rec`, or two economic indicators).

Plot both series and their cross-correlation function.

```{r}
#| label: ex4-two-series

# Your code here
```

*Do the series appear related? At what lag?*



### Task 4.2: Coherence Analysis

Coherence measures the correlation between two series at each frequency (like R² in regression, but frequency-specific).

Compute and plot the coherence using `astsa::mvspec()`.

```{r}
#| label: ex4-coherence

# Your code here
```

*At what frequencies are the series most strongly related?*



### Task 4.3: Interpret the Coherence

High coherence at a specific frequency means the series share a common cycle at that frequency.

*What does the coherence tell you about the relationship between your two series?*



---

## Practice Problems

### Problem 1

A colleague claims they found a 7-day cycle in their data. The spectral peak is at frequency 0.143. How would you confirm or correct your colleague? What would the frequency be for a 30-day cycle?

*Your calculation:*



### Problem 2

Suppose a friend is just beginning to study time series analysis. How would you explain to them the benefits of these two perspectives: time domain and frequency domain? What examples would you give them of a question better answered in each domain?

*Your response:*



---

## Reflection

<!-- What did you learn? What remains unclear? What would you do differently next time? -->

